[file name]: checkout.html
[file content begin]
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ - LunchTime</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="builder.css">
    <style>
        .checkout-page {
            padding: 2rem 5%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .checkout-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .order-summary-section, .order-form-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .order-summary-section h3, .order-form-section h3 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 3px solid #e74c3c;
        }
        
        .empty-order {
            text-align: center;
            padding: 3rem;
            color: #6c757d;
            font-style: italic;
        }
        
        .empty-order a {
            color: #e74c3c;
            text-decoration: none;
            font-weight: 500;
        }
        
        .empty-order a:hover {
            text-decoration: underline;
        }
        
        .selected-dish-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .dish-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }
        
        .dish-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
        }
        
        .dish-text {
            flex: 1;
        }
        
        .dish-name {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 0.3rem;
        }
        
        .dish-details {
            display: flex;
            gap: 1rem;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .dish-price {
            font-weight: bold;
            color: #ffffff;
            min-width: 80px;
            text-align: right;
        }
        
        .remove-dish-btn {
            background: #ff5252;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
            margin-left: 1rem;
            flex-shrink: 0;
        }
        
        .remove-dish-btn:hover {
            background: #ff1a1a;
        }
        
        .total-price {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid #e74c3c;
            text-align: right;
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        @media (max-width: 1024px) {
            .checkout-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .dish-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .dish-image {
                align-self: center;
            }
            
            .dish-details {
                flex-direction: column;
                gap: 0.3rem;
            }
            
            .dish-price {
                text-align: left;
            }
        }
        
        .form-section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .form-section-title .icon {
            font-size: 24px;
        }
        
        .delivery-time-input {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100%;
        }
        
        .submit-section {
            margin-top: 30px;
            text-align: center;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }
        
        .submit-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .form-group {
            margin-bottom: 1.8rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.8rem;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1rem;
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="tel"],
        .form-group input[type="time"],
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
            background-color: #fafafa;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #e74c3c;
            background-color: #fff;
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
            line-height: 1.5;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 0;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin: 0;
            accent-color: #e74c3c;
        }

        .checkbox-group label {
            margin-bottom: 0;
            cursor: pointer;
            font-weight: 500;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.8rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        .radio-option:hover {
            background-color: #e9ecef;
        }

        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
            margin: 0;
            accent-color: #e74c3c;
        }

        .radio-option label {
            margin-bottom: 0;
            cursor: pointer;
            font-weight: 500;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">Lunch<span>Time</span></div>
            <ul>
                <li><a href="index.html">–û –Ω–∞—Å</a></li>
                <li><a href="builder.html">–°–æ–±—Ä–∞—Ç—å –ª–∞–Ω—á</a></li>
                <li><a href="checkout.html" id="active">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</a></li>
                <li><a href="index.html#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
            </ul>
        </nav>
    </header>

    <main class="checkout-page">
        <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
        
        <div class="checkout-container">
            <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –ü—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –±–ª—é–¥ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —É–¥–∞–ª–µ–Ω–∏—è -->
            <section class="order-summary-section">
                <h3>–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞</h3>
                
                <!-- –°–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –±–ª—é–¥ -->
                <div id="order-items-list">
                    <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                    <div class="empty-order">
                        <p>–ù–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ. –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–∞ –≤ –∑–∞–∫–∞–∑, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É 
                        <a href="builder.html">–°–æ–±—Ä–∞—Ç—å –ª–∞–Ω—á</a>.</p>
                    </div>
                </div>
                
                <div id="order-total" class="total-price" style="display: none;">
                    –ò—Ç–æ–≥–æ: <span id="total-amount">0</span> —Ä—É–±.
                </div>
            </section>
            
            <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –§–æ—Ä–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è -->
            <section class="order-form-section">
                <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
                
                <div class="form-section-title">
                    <span class="icon">üë§</span>
                    <h4>–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</h4>
                </div>
                
                <div class="form-group">
                    <label for="full_name">–ò–º—è *</label>
                    <input type="text" id="full_name" name="full_name" required>
                </div>

                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group checkbox-group">
                    <input type="checkbox" id="subscribe" name="subscribe" checked>
                    <label for="subscribe">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É</label>
                </div>

                <div class="form-group">
                    <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>

                <div class="form-group">
                    <label for="delivery_address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                    <input type="text" id="delivery_address" name="delivery_address" required>
                </div>

                <div class="form-group">
                    <label>–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="delivery_type_now" name="delivery_type" value="now" required>
                            <label for="delivery_type_now">–ö–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="delivery_type_by_time" name="delivery_type" value="by_time" required>
                            <label for="delivery_type_by_time">–£–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º—è</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="delivery_time">–£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                    <input type="time" id="delivery_time" name="delivery_time" 
                           min="07:00" max="23:00" step="300" class="delivery-time-input" disabled>
                </div>
                
                <div class="form-group">
                    <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
                    <textarea id="comment" name="comment" rows="4" placeholder="–í–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è..."></textarea>
                </div>
                
                <div class="submit-section">
                    <button type="submit" id="submit-order-btn" class="submit-btn" disabled>
                        –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑
                    </button>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="logo">Lunch<span>Time</span></div>
            <p>¬© 2023 –î–æ—Å—Ç–∞–≤–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–∞–Ω—á–µ–π –≤ –ú–æ—Å–∫–≤–µ</p>
            <ul>
                <li><a href="index.html">–û –Ω–∞—Å</a></li>
                <li><a href="builder.html">–°–æ–±—Ä–∞—Ç—å –ª–∞–Ω—á</a></li>
                <li><a href="checkout.html" id="active">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</a></li>
                <li><a href="index.html#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
            </ul>
        </div>
    </footer>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div class="notifications-container"></div>

    <script>
        // API –∫–ª—é—á - –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –∫–ª—é—á!
        const API_KEY = '2b974891-4ca2-4132-9a60-d2cdb785f6bd';
        
        const API_BASE_URL = window.location.hostname.includes('github.io') || 
                             window.location.hostname.includes('netlify.app') || 
                             window.location.hostname.includes('vercel.app')
            ? 'https://edu.std-900.ist.mospolytech.ru'
            : 'http://lab8-api.std-900.ist.mospolytech.ru';
        
        let dishes = [];
        let currentOrder = {};
        
        async function loadDishes() {
            try {
                const url = `${API_BASE_URL}/labs/api/dishes?api_key=${API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–ª—é–¥');
                
                dishes = await response.json();
                console.log('–ë–ª—é–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', dishes.length, '—à—Ç.');
                
                loadOrderFromStorage();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–ª—é–¥:', error);
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–Ω—é. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.');
            }
        }
        
        function loadOrderFromStorage() {
            const savedOrder = localStorage.getItem('lunchtime_order');
            if (savedOrder) {
                try {
                    const orderData = JSON.parse(savedOrder);
                    console.log('–ó–∞–∫–∞–∑ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ localStorage:', orderData);
                    
                    Object.entries(orderData).forEach(([category, keyword]) => {
                        const dish = dishes.find(d => d.keyword === keyword);
                        if (dish) {
                            currentOrder[category] = dish;
                        }
                    });
                    
                    updateOrderDisplay();
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞:', error);
                }
            }
        }
        
        function updateOrderDisplay() {
            const orderItemsList = document.getElementById('order-items-list');
            const orderTotal = document.getElementById('order-total');
            const totalAmount = document.getElementById('total-amount');
            const submitBtn = document.getElementById('submit-order-btn');
            
            if (!orderItemsList || !orderTotal || !totalAmount || !submitBtn) {
                console.error('–ù–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã DOM');
                return;
            }
        
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
            orderItemsList.innerHTML = '';
            
            const selectedDishes = Object.values(currentOrder).filter(dish => dish !== null);
            
            if (selectedDishes.length === 0) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—É—Å—Ç–æ–º –∑–∞–∫–∞–∑–µ
                orderItemsList.innerHTML = `
                    <div class="empty-order">
                        <p>–ù–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ. –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–∞ –≤ –∑–∞–∫–∞–∑, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É 
                        <a href="builder.html">–°–æ–±—Ä–∞—Ç—å –ª–∞–Ω—á</a>.</p>
                    </div>
                `;
                orderTotal.style.display = 'none';
                submitBtn.disabled = true;
                return;
            }
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å
            const total = selectedDishes.reduce((sum, dish) => sum + dish.price, 0);
            totalAmount.textContent = total;
            orderTotal.style.display = 'block';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–º–±–æ
            const isValidCombo = checkOrderCombo();
            submitBtn.disabled = !isValidCombo;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∂–¥–æ–µ –±–ª—é–¥–æ –≤ –≤–∏–¥–µ –ø—Ä–æ—Å—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞
            selectedDishes.forEach(dish => {
                const dishElement = createDishElement(dish);
                orderItemsList.appendChild(dishElement);
            });
        }
        
        function createDishElement(dish) {
            const div = document.createElement('div');
            div.className = 'selected-dish-item';
            div.innerHTML = `
                <div class="dish-info">
                    <img src="${dish.image}" alt="${dish.name}" class="dish-image" onerror="this.src='placeholder.jpg'">
                    <div class="dish-text">
                        <div class="dish-name">${dish.name}</div>
                        <div class="dish-details">
                            <span>${dish.count}</span>
                        </div>
                    </div>
                    <div class="dish-price">${dish.price} —Ä—É–±.</div>
                </div>
                <button class="remove-dish-btn" data-keyword="${dish.keyword}">‚úï</button>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–¥–∞–ª–µ–Ω–∏—è
            const removeBtn = div.querySelector('.remove-dish-btn');
            removeBtn.addEventListener('click', () => removeDishFromOrder(dish.keyword));
            
            return div;
        }
        
        function removeDishFromOrder(keyword) {
            // –ù–∞—Ö–æ–¥–∏–º –±–ª—é–¥–æ
            const dish = dishes.find(d => d.keyword === keyword);
            if (!dish) return;
            
            // –ù–∞—Ö–æ–¥–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            let category = dish.category;
            if (category === 'main-course') {
                category = 'main';
            }
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–∫–∞–∑–∞
            delete currentOrder[category];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º localStorage
            saveOrderToStorage();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateOrderDisplay();
            
            showNotification(`–ë–ª—é–¥–æ —É–¥–∞–ª–µ–Ω–æ –∏–∑ –∑–∞–∫–∞–∑–∞`, 'info');
        }
        
        function saveOrderToStorage() {
            const orderToSave = {};
            Object.entries(currentOrder).forEach(([category, dish]) => {
                if (dish) {
                    orderToSave[category] = dish.keyword;
                }
            });
            localStorage.setItem('lunchtime_order', JSON.stringify(orderToSave));
        }
        
        function checkOrderCombo() {
            const hasSoup = currentOrder.soup !== null;
            const hasMain = currentOrder.main !== null;
            const hasSalad = currentOrder.salad !== null;
            const hasDrink = currentOrder.drink !== null;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–æ–º–±–æ –∏–∑ –±–∏–∑–Ω–µ—Å-–ª–∞–Ω—á–µ–π
            const combo1 = hasSoup && hasMain && hasSalad && hasDrink;
            const combo2 = hasSoup && hasMain && hasDrink;
            const combo3 = hasSoup && hasSalad && hasDrink;
            const combo4 = hasMain && hasSalad && hasDrink;
            const combo5 = hasMain && hasDrink;
            
            return combo1 || combo2 || combo3 || combo4 || combo5;
        }
        
        function initEventListeners() {
            const deliveryTimeByTimeRadio = document.getElementById('delivery_type_by_time');
            const deliveryTimeNowRadio = document.getElementById('delivery_type_now');
            const deliveryTimeInput = document.getElementById('delivery_time');
            const submitBtn = document.getElementById('submit-order-btn');
            
            if (deliveryTimeByTimeRadio && deliveryTimeInput) {
                deliveryTimeByTimeRadio.addEventListener('change', function() {
                    deliveryTimeInput.disabled = !this.checked;
                    if (this.checked) {
                        deliveryTimeInput.required = true;
                    }
                });
            }
            
            if (deliveryTimeNowRadio && deliveryTimeInput) {
                deliveryTimeNowRadio.addEventListener('change', function() {
                    deliveryTimeInput.disabled = this.checked;
                    if (this.checked) {
                        deliveryTimeInput.required = false;
                    }
                });
            }
            
            if (submitBtn) {
                submitBtn.addEventListener('click', submitOrder);
            }
        }
        
        function collectFormData() {
            return {
                full_name: getElementValue('full_name'),
                email: getElementValue('email'),
                subscribe: getCheckboxValue('subscribe'),
                phone: getElementValue('phone'),
                delivery_address: getElementValue('delivery_address'),
                comment: getElementValue('comment'),
                delivery_type: getRadioValue('delivery_type'),
                delivery_time: getElementValue('delivery_time')
            };
        }
        
        function getElementValue(id) {
            const element = document.getElementById(id);
            return element ? element.value.trim() : '';
        }
        
        function getCheckboxValue(id) {
            const checkbox = document.getElementById(id);
            return checkbox ? (checkbox.checked ? 1 : 0) : 0;
        }
        
        function getRadioValue(name) {
            const radio = document.querySelector(`input[name="${name}"]:checked`);
            return radio ? radio.value : '';
        }
        
        function validateFormData(data) {
            const requiredFields = ['full_name', 'email', 'phone', 'delivery_address', 'delivery_type'];
            
            for (const field of requiredFields) {
                if (!data[field] || data[field].trim() === '') {
                    showError(`–ü–æ–ª–µ "${getFieldName(field)}" –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è`);
                    return false;
                }
            }
            
            if (data.delivery_type === 'by_time' && (!data.delivery_time || data.delivery_time.trim() === '')) {
                showError('–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏');
                return false;
            }
            
            if (!isValidEmail(data.email)) {
                showError('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å');
                return false;
            }
            
            return true;
        }
        
        function getFieldName(field) {
            const fieldNames = {
                'full_name': '–ò–º—è',
                'email': 'Email',
                'phone': '–¢–µ–ª–µ—Ñ–æ–Ω',
                'delivery_address': '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏',
                'delivery_type': '–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏'
            };
            return fieldNames[field] || field;
        }
        
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        async function submitOrder() {
            const submitBtn = document.getElementById('submit-order-btn');
            if (!submitBtn) return;
            
            submitBtn.disabled = true;
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞...';
            
            try {
                if (!checkOrderCombo()) {
                    throw new Error('–í—ã–±—Ä–∞–Ω–Ω—ã–µ –±–ª—é–¥–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –Ω–∏ –æ–¥–Ω–æ–º—É –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–±–æ.');
                }
                
                const formData = collectFormData();
                if (!validateFormData(formData)) {
                    throw new Error('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã');
                }
                
                const apiData = prepareApiData(formData);
                const url = `${API_BASE_URL}/labs/api/orders?api_key=${API_KEY}`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(apiData)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(errorText || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–∫–∞–∑–∞');
                }
                
                const result = await response.json();
                console.log('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω:', result);
                
                localStorage.removeItem('lunchtime_order');
                
                showNotification('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.', 'success');
                
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 3000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞:', error);
                showError(error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }
        
        function prepareApiData(formData) {
            const apiData = { ...formData };
            
            Object.entries(currentOrder).forEach(([category, dish]) => {
                if (dish) {
                    let apiField;
                    switch(category) {
                        case 'soup': apiField = 'soup_id'; break;
                        case 'main': apiField = 'main_course_id'; break;
                        case 'salad': apiField = 'salad_id'; break;
                        case 'drink': apiField = 'drink_id'; break;
                        case 'dessert': apiField = 'dessert_id'; break;
                        default: apiField = category;
                    }
                    apiData[apiField] = dish.id || 0;
                }
            });
            
            return apiData;
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-overlay"></div>
                <div class="notification-content">
                    <h3>${type === 'success' ? '–£—Å–ø–µ—Ö!' : type === 'error' ? '–û—à–∏–±–∫–∞!' : '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}</h3>
                    <p>${message}</p>
                    <button class="notification-ok-btn">OK</button>
                </div>
            `;
            
            const container = document.querySelector('.notifications-container');
            if (!container) return;
            
            container.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 10);
            
            const okBtn = notification.querySelector('.notification-ok-btn');
            if (okBtn) {
                okBtn.addEventListener('click', () => {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 300);
                });
            }
            
            const overlay = notification.querySelector('.notification-overlay');
            if (overlay) {
                overlay.addEventListener('click', () => {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 300);
                });
            }
            
            if (type === 'success') {
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.classList.remove('show');
                        setTimeout(() => notification.remove(), 300);
                    }
                }, 5000);
            }
        }
        
        function showError(message) {
            showNotification(message, 'error');
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            loadDishes();
            initEventListeners();
        });
    </script>
</body>
</html>
[file content end]

